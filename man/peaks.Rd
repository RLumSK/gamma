% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R, R/peaks.R
\docType{methods}
\name{peaks}
\alias{peaks}
\alias{findPeaks}
\alias{findPeaks-method}
\alias{fitPeaks}
\alias{fitPeaks-method}
\alias{findPeaks,GammaSpectrum-method}
\alias{fitPeaks,GammaSpectrum,numeric-method}
\alias{fitPeaks,GammaSpectrum-method}
\alias{fitPeaks,PeakPosition,missing-method}
\title{Peaks}
\usage{
findPeaks(object, ...)

fitPeaks(object, peaks, ...)

\S4method{findPeaks}{GammaSpectrum}(object, method = c("MAD"), SNR = 2,
  span = NULL, ...)

\S4method{fitPeaks}{GammaSpectrum,numeric}(object, peaks,
  scale = c("energy", "chanel"), bounds = NULL, ...)

\S4method{fitPeaks}{PeakPosition,missing}(object, scale = c("energy",
  "chanel"), bounds = NULL, ...)
}
\arguments{
\item{object}{An object of class \linkS4class{GammaSpectrum}.}

\item{...}{Extra parameters passed to internal functions.}

\item{peaks}{XXX.}

\item{method}{A \code{\link{character}} string.}

\item{SNR}{An \code{\link{integer}}.}

\item{span}{An \code{\link{integer}} giving the half window size (in number
of chanels). If \code{NULL}, 5\% of the number of chanels is used as the
half window size.}

\item{scale}{XXX.}

\item{bounds}{A \code{\link{numeric}} vector.}
}
\value{
\code{findPeaks} returns an object of class \linkS4class{PeakPosition}.

 \code{fitPeaks} returns an object of class \linkS4class{PeakModel}.
}
\description{
Finds local maxima in sequential data.
}
\details{
A local maximum has to be the highest one in the given window and has to be
 higher than \eqn{SNR \times noise}{SNR * noise} to be recognized as peak.
}
\examples{
# Import a CNF file
spc_dir <- system.file("extdata/test.cnf", package = "gamma")
spc <- read(spc_dir, skip = 1:35)

# Estimate baseline
baseline <- estimateBaseline(spc)

plot(spc, baseline) +
  ggplot2::labs(x = "Energy [keV]", y = "Counts")

# Remove baseline
spc_clean <- removeBaseline(spc)

plot(spc_clean) +
  ggplot2::labs(x = "Energy [keV]", y = "Counts")

# Detect peaks
peak_index <- findPeaks(spc, span = 20)

plot(peak_index) +
  ggplot2::labs(x = "Energy [keV]", y = "Counts") +
  ggplot2::theme_bw()

# Fit peaks
peak_fit <- fitPeaks(spc, peaks = c(238, 1461, 2614.5), scale = "energy")

plot(peak_fit) +
  ggplot2::labs(x = "Energy [keV]", y = "Counts") +
  ggplot2::theme_bw()
}
\author{
N. Frerebeau
}
